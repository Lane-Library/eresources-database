<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd">
    <import resource="db-load.xml"/>
    <bean id="ETL" class="edu.stanford.irt.eresources.jdbc.JDBCEresourcesETLApp" parent="abstractETL">
        <constructor-arg ref="erdbDataSource"/>
        <property name="createStatements">
            <list>
                <value>DROP SEQUENCE ERESOURCE_ID_SEQ</value>
                <value>DROP SEQUENCE VERSION_ID_SEQ</value>
                <value>DROP SEQUENCE LINK_ID_SEQ</value>
                <value>DROP INDEX TYPE_IDX</value>
                <value>DROP INDEX TYPE_TYPE_IDX</value>
                <value>DROP INDEX VERSION_IDX</value>
                <value>DROP INDEX LINK_IDX</value>
                <value>DROP INDEX TEXT_IDX</value>
                <value>DROP INDEX TITLE_IDX</value>
                <value>DROP INDEX TITLE_CONVERT_IDX</value>
                <value>DROP INDEX SUBSET_IDX</value>
                <value>DROP INDEX SUBSET_VERSION_IDX</value>
                <value>DROP INDEX SUBSET_SUBSET_IDX</value>
                <value>DROP INDEX MESH_IDX</value>
                <value>DROP INDEX MESH_TERM_IDX</value>
                <value>DROP INDEX ERESOURCE_CORE_IDX</value>
                <value>DROP INDEX ERESOURCE_TYPE_IDX</value>
                
                <value>DROP INDEX VERSION_ERESOURCE_ID_IDX</value>
                <value>DROP INDEX ERESOURCE_CORE_IDX</value>
                <value>DROP INDEX LINK_VERSION_ID_IDX</value>
                <value>DROP INDEX MESH_ERESOURCE_ID_IDX</value>
                <value>DROP INDEX TYPE_TYPE_RESOURCE_ID_IDX</value>
                <value>DROP INDEX SUBSET_SUBSET_VERSION_ID_IDX</value>
                <value>DROP INDEX ERESOURCE_LOWER_TITLE_IDX</value>
                
                <value>DROP TABLE ERESOURCE</value>
                <value>DROP TABLE VERSION</value>
                <value>DROP TABLE LINK</value>
                <value>DROP TABLE TYPE</value>
                <value>DROP TABLE SUBSET</value>
                <value>DROP TABLE MESH</value>
                <value>CREATE SEQUENCE ERESOURCE_ID_SEQ MAXVALUE 99999999 CYCLE</value>
                <value>CREATE SEQUENCE VERSION_ID_SEQ MAXVALUE 99999999 CYCLE</value>
                <value>CREATE SEQUENCE LINK_ID_SEQ MAXVALUE 99999999 CYCLE</value>
                <value>CREATE TABLE ERESOURCE (ERESOURCE_ID NUMBER(8,0) PRIMARY KEY, RECORD_ID
                    NUMBER(12,0), RECORD_TYPE VARCHAR2(8), UPDATED DATE, TITLE VARCHAR2(512),
                    CORE CHAR(1), YEAR NUMBER(4,0), DESCRIPTION CLOB, TEXT CLOB, PRIMARY_TYPE VARCHAR(256), TOTAL NUMBER(4,0), AVAILABLE NUMBER(4,0))
                    LOB (TEXT) store as securefile
                    LOB (DESCRIPTION) store as securefile</value>
                <value>CREATE TABLE VERSION (VERSION_ID NUMBER(8,0) PRIMARY KEY, ERESOURCE_ID
                    NUMBER(8,0), PROXY CHAR(1), GETPASSWORD CHAR(1), SEQNUM NUMBER(2,0),
                    ADDITIONAL_TEXT VARCHAR(512), PUBLISHER VARCHAR(256))</value>
                <value>CREATE TABLE LINK (LINK_ID NUMBER(8,0) PRIMARY KEY, VERSION_ID NUMBER(8,0),
                    ERESOURCE_ID NUMBER(8,0), LABEL VARCHAR2(256), URL VARCHAR2(1200),
                    LINK_TEXT VARCHAR2(512), ADDITIONAL_TEXT VARCHAR(512))</value>
                <value>CREATE TABLE TYPE (ERESOURCE_ID NUMBER(8,0), TYPE VARCHAR2(256))</value>
                <value>CREATE TABLE SUBSET (VERSION_ID NUMBER(8,0), ERESOURCE_ID NUMBER(8,0), SUBSET
                    VARCHAR(256))</value>
                <value>CREATE TABLE MESH (ERESOURCE_ID NUMBER(8,0), TERM VARCHAR2(256))</value>
            </list>
        </property>
        <property name="callStatements">
            <list>
                <value>CREATE INDEX VERSION_ERESOURCE_ID_IDX ON VERSION("ERESOURCE_ID")</value>
                <value>CREATE INDEX ERESOURCE_CORE_IDX ON ERESOURCE("CORE")</value>
                <value>CREATE INDEX LINK_VERSION_ID_IDX ON LINK("VERSION_ID")</value>
                <value>CREATE INDEX MESH_ERESOURCE_ID_IDX ON MESH("TERM","ERESOURCE_ID")</value>
                <value>CREATE INDEX TYPE_TYPE_RESOURCE_ID_IDX ON TYPE("TYPE","ERESOURCE_ID")</value>
                <value>CREATE INDEX SUBSET_SUBSET_VERSION_ID_IDX ON SUBSET("SUBSET","VERSION_ID")</value>
                <value>CREATE INDEX TITLE_CONVERT_IDX ON ERESOURCE(CONVERT(LOWER("TITLE"),'US7ASCII'))</value>
                <value>CREATE INDEX TEXT_IDX ON ERESOURCE(TEXT) INDEXTYPE IS CTXSYS.CONTEXT</value>
                <value>CREATE INDEX TITLE_IDX ON ERESOURCE(TITLE) INDEXTYPE IS CTXSYS.CONTEXT</value>
                 <value>'{' call dbms_stats.gather_schema_stats(ownname=>''{0}'',cascade=>TRUE,estimate_percent => dbms_stats.auto_sample_size)'}'</value>
            </list>
        </property>
        <property name="userName" value="ceyates"/>
    </bean>
<!--    <bean id="eresourceHandler" class="edu.stanford.irt.eresources.jdbc.JDBCLoader">
        <constructor-arg ref="erdbDataSource"/>
        <constructor-arg ref="eresourceTranslator"/>
        <constructor-arg ref="executor"/>
    </bean>-->
    <bean id="bibInputStream" class="edu.stanford.irt.eresources.marc.BibInputStream">
        <constructor-arg name="dataSource" ref="voyagerDataSource"/>
        <constructor-arg name="executor" ref="executor"/>
    </bean>
    <bean id="authInputStream" class="edu.stanford.irt.eresources.marc.AuthInputStream">
        <constructor-arg name="dataSource" ref="voyagerDataSource"/>
        <constructor-arg name="executor" ref="executor"/>
    </bean>
    <bean id="printBibInputStream" class="edu.stanford.irt.eresources.marc.PrintBibInputStream">
        <constructor-arg name="dataSource" ref="voyagerDataSource"/>
        <constructor-arg name="executor" ref="executor"/>
    </bean>
</beans>
